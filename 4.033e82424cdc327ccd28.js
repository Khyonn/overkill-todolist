(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{U6jk:function(t,e,n){"use strict";n.r(e),n.d(e,"TodoModule",function(){return Lt});var o=n("ofXK"),i=n("l7P3"),s=n("9jGm"),c=n("PCNd"),r=n("tyNb"),a=n("IzEk"),d=n("lJxs");const l=Object(i.n)("[TodoList] Start loading"),b=Object(i.n)("[TodoList] Data loaded",Object(i.s)()),u=Object(i.n)("[TodoList] Loading failed",Object(i.s)()),O=Object(i.n)("[TodoList] Start loading todo",Object(i.s)()),f=Object(i.n)("[TodoList] Todo loaded",Object(i.s)()),p=Object(i.n)("[TodoList] Loading todo failed",Object(i.s)()),h=Object(i.n)("[TodoList] Start update todo state",Object(i.s)()),g=Object(i.n)("[TodoList] Todo state updated",Object(i.s)()),j=Object(i.n)("[TodoList] Todo state update failed",Object(i.s)()),m=Object(i.n)("[TodoList] Start creating todo",Object(i.s)()),y=Object(i.n)("[TodoList] Todo created",Object(i.s)()),v=Object(i.n)("[TodoList] Todo failed to create",Object(i.s)());var T=n("99NH");const P=Object(i.o)("router"),{selectRouteParam:C}=T.b(P);var w=n("fXoL");const I={EntitiesOnly:0,Both:1,None:2};function L(t){return function(e,n){const o={ids:[...n.ids],entities:Object.assign({},n.entities)},i=t(e,o);return i===I.Both?Object.assign({},n,o):i===I.EntitiesOnly?Object.assign(Object.assign({},n),{entities:o.entities}):n}}function M(t,e){const n=e(t);return Object(w.W)()&&void 0===n&&console.warn("@ngrx/entity: The entity passed to the `selectId` implementation returned undefined.","You should probably provide your own `selectId` implementation.","The entity that was passed:",t,"The `selectId` implementation:",e.toString()),n}function N(t){function e(e,n){const o=M(e,t);return o in n.entities?I.None:(n.ids.push(o),n.entities[o]=e,I.Both)}function n(t,n){let o=!1;for(const i of t)o=e(i,n)!==I.None||o;return o?I.Both:I.None}function o(t,e){return e.ids=[],e.entities={},n(t,e),I.Both}function i(t,e){const n=(t instanceof Array?t:e.ids.filter(n=>t(e.entities[n]))).filter(t=>t in e.entities).map(t=>delete e.entities[t]).length>0;return n&&(e.ids=e.ids.filter(t=>t in e.entities)),n?I.Both:I.None}function s(t,e){return c([t],e)}function c(e,n){const o={};return(e=e.filter(t=>t.id in n.entities)).length>0?e.filter(e=>function(e,n,o){const i=Object.assign({},o.entities[n.id],n.changes),s=M(i,t),c=s!==n.id;return c&&(e[n.id]=s,delete o.entities[n.id]),o.entities[s]=i,c}(o,e,n)).length>0?(n.ids=n.ids.map(t=>o[t]||t),I.Both):I.EntitiesOnly:I.None}function r(e,o){const i=[],s=[];for(const n of e){const e=M(n,t);e in o.entities?s.push({id:e,changes:n}):i.push(n)}const r=c(s,o),a=n(i,o);switch(!0){case a===I.None&&r===I.None:return I.None;case a===I.Both||r===I.Both:return I.Both;default:return I.EntitiesOnly}}return{removeAll:function(t){return Object.assign({},t,{ids:[],entities:{}})},addOne:L(e),addMany:L(n),addAll:L(o),setAll:L(o),setOne:L(function(e,n){const o=M(e,t);return o in n.entities?(n.entities[o]=e,I.EntitiesOnly):(n.ids.push(o),n.entities[o]=e,I.Both)}),updateOne:L(s),updateMany:L(c),upsertOne:L(function(t,e){return r([t],e)}),upsertMany:L(r),removeOne:L(function(t,e){return i([t],e)}),removeMany:L(i),map:L(function(t,e){return c(e.ids.reduce((n,o)=>{const i=t(e.entities[o]);return i!==e.entities[o]&&n.push({id:o,changes:i}),n},[]).filter(({id:t})=>t in e.entities),e)}),mapOne:L(function({map:t,id:e},n){const o=n.entities[e];return o?s({id:e,changes:t(o)},n):I.None})}}I[I.EntitiesOnly]="EntitiesOnly",I[I.Both]="Both",I[I.None]="None";var k=function(t){return t.DONE="DONE",t.TODO="TODO",t}({});class E{constructor(t="",e=k.TODO,n){this.title=t,this.state=e,this.id=n}static isDone(t){return!!t&&t.state===k.DONE}}class x extends E{constructor(t,e,n,o){super(t,e,n),this.description=o}}const A=function(t={}){const{selectId:e,sortComparer:n}=Object.assign({sortComparer:!1,selectId:t=>t.id},t),o={getInitialState:function(t={}){return Object.assign({ids:[],entities:{}},t)}},s={getSelectors:function(t){const e=t=>t.ids,n=t=>t.entities,o=Object(i.q)(e,n,(t,e)=>t.map(t=>e[t])),s=Object(i.q)(e,t=>t.length);return t?{selectIds:Object(i.q)(t,e),selectEntities:Object(i.q)(t,n),selectAll:Object(i.q)(t,o),selectTotal:Object(i.q)(t,s)}:{selectIds:e,selectEntities:n,selectAll:o,selectTotal:s}}},c=n?function(t,e){const{removeOne:n,removeMany:o,removeAll:i}=N(t);function s(t,e){return c([t],e)}function c(e,n){const o=e.filter(e=>!(M(e,t)in n.entities));return 0===o.length?I.None:(b(o,n),I.Both)}function r(t,e){return e.entities={},e.ids=[],c(t,e),I.Both}function a(t,e){return d([t],e)}function d(e,n){const o=[],i=e.filter(e=>function(e,n,o){if(!(n.id in o.entities))return!1;const i=Object.assign({},o.entities[n.id],n.changes),s=M(i,t);return delete o.entities[n.id],e.push(i),s!==n.id}(o,e,n)).length>0;if(0===o.length)return I.None;{const t=n.ids,e=[];return n.ids=n.ids.filter((t,o)=>t in n.entities||(e.push(o),!1)),b(o,n),!i&&e.every(e=>n.ids[e]===t[e])?I.EntitiesOnly:I.Both}}function l(e,n){const o=[],i=[];for(const c of e){const e=M(c,t);e in n.entities?i.push({id:e,changes:c}):o.push(c)}const s=d(i,n),r=c(o,n);switch(!0){case r===I.None&&s===I.None:return I.None;case r===I.Both||s===I.Both:return I.Both;default:return I.EntitiesOnly}}function b(n,o){n.sort(e);const i=[];let s=0,c=0;for(;s<n.length&&c<o.ids.length;){const r=n[s],a=M(r,t),d=o.ids[c];e(r,o.entities[d])<=0?(i.push(a),s++):(i.push(d),c++)}o.ids=i.concat(s<n.length?n.slice(s).map(t):o.ids.slice(c)),n.forEach((e,n)=>{o.entities[t(e)]=e})}return{removeOne:n,removeMany:o,removeAll:i,addOne:L(s),updateOne:L(a),upsertOne:L(function(t,e){return l([t],e)}),addAll:L(r),setAll:L(r),setOne:L(function(e,n){const o=M(e,t);return o in n.entities?(n.ids=n.ids.filter(t=>t!==o),b([e],n),I.Both):s(e,n)}),addMany:L(c),updateMany:L(d),upsertMany:L(l),map:L(function(t,e){return d(e.ids.reduce((n,o)=>{const i=t(e.entities[o]);return i!==e.entities[o]&&n.push({id:o,changes:i}),n},[]),e)}),mapOne:L(function({map:t,id:e},n){const o=n.entities[e];return o?a({id:e,changes:t(o)},n):I.None})}}(e,n):N(e);return Object.assign(Object.assign(Object.assign({selectId:e,sortComparer:n},o),s),c)}({selectId:t=>t.id,sortComparer:class{static todoListSorter(t,e){return E.isDone(t)!==E.isDone(e)?E.isDone(t)?1:-1:0}}.todoListSorter}),S=A.getInitialState({isLoading:!1,error:null}),D="todosFeature",B=Object(i.o)(D),{selectAll:q,selectEntities:_}=A.getSelectors(Object(i.q)(B,({todoList:t})=>t)),F=Object(i.q)(C("todoId"),t=>+t),G=q,$=Object(i.q)(_,F,(t,e)=>t[e]);let K=(()=>{class t{constructor(t){this.store=t}resolve(){return this.store.dispatch(l()),this.store.select(G).pipe(Object(a.a)(1),Object(d.a)(()=>!0))}}return t.\u0275fac=function(e){return new(e||t)(w.Tb(i.h))},t.\u0275prov=w.Gb({token:t,factory:t.\u0275fac}),t})();var W=n("Wp6s");function R(t,e){if(1&t&&(w.Pb(0,"mat-card"),w.Pb(1,"mat-card-title"),w.rc(2),w.Ob(),w.Pb(3,"mat-card-content"),w.rc(4),w.Ob(),w.Ob()),2&t){const t=w.ac();w.Ab(2),w.uc("Todo #",t.todo.id," : ",t.todo.title," (",t.todo.state,")"),w.Ab(2),w.tc(" ",t.todo.description," ")}}let J=(()=>{class t{constructor(t){this.store=t}ngOnInit(){this.store.select($).subscribe(t=>{this.todo=t})}}return t.\u0275fac=function(e){return new(e||t)(w.Kb(i.h))},t.\u0275cmp=w.Eb({type:t,selectors:[["app-todo-detail"]],decls:1,vars:1,consts:[[4,"ngIf"]],template:function(t,e){1&t&&w.qc(0,R,5,4,"mat-card",0),2&t&&w.dc("ngIf",e.todo)},directives:[o.j,W.a,W.d,W.b],styles:["mat-card[_ngcontent-%COMP%]{flex:1}"]}),t})(),z=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=w.Eb({type:t,selectors:[["app-todo-detail-page"]],decls:1,vars:0,template:function(t,e){1&t&&w.Lb(0,"app-todo-detail")},directives:[J],styles:["[_nghost-%COMP%]{height:100%}app-todo-detail[_ngcontent-%COMP%]{display:flex;padding:1em;min-height:100%;box-sizing:border-box}"]}),t})();var H=n("3Pt+"),U=n("0IaG"),X=n("kmnG"),Q=n("qFsG"),V=n("bTqV");function Y(t,e){1&t&&(w.Pb(0,"mat-error"),w.rc(1,"The title is required"),w.Ob())}let Z=(()=>{class t{constructor(t,e,n){this.fb=t,this.dialogRef=e,this.store=n,this.form=this.fb.group({title:this.fb.control("",[H.m.required]),description:this.fb.control("")})}onSubmit(){const t=Object.assign(new x,this.form.value);this.store.dispatch(m({todoToCreate:t})),this.dialogRef.close()}onClickCancel(){this.dialogRef.close()}}return t.\u0275fac=function(e){return new(e||t)(w.Kb(H.c),w.Kb(U.e),w.Kb(i.h))},t.\u0275cmp=w.Eb({type:t,selectors:[["app-add-todo-modal"]],decls:18,vars:2,consts:[[3,"formGroup","ngSubmit"],["mat-dialog-title",""],["mat-dialog-content","",1,"form-fields"],["matInput","","formControlName","title"],[4,"ngIf"],["matInput","","formControlName","description"],["mat-dialog-actions","",1,"actions"],["type","button","mat-button","",3,"click"],["type","submit","mat-raised-button","","color","primary"]],template:function(t,e){1&t&&(w.Pb(0,"form",0),w.Wb("ngSubmit",function(){return e.form.valid&&e.onSubmit()}),w.Pb(1,"h1",1),w.rc(2,"Add a new todo"),w.Ob(),w.Pb(3,"div",2),w.Pb(4,"mat-form-field"),w.Pb(5,"mat-label"),w.rc(6,"Title"),w.Ob(),w.Lb(7,"input",3),w.qc(8,Y,2,0,"mat-error",4),w.Ob(),w.Pb(9,"mat-form-field"),w.Pb(10,"mat-label"),w.rc(11,"Description"),w.Ob(),w.Lb(12,"textarea",5),w.Ob(),w.Ob(),w.Pb(13,"div",6),w.Pb(14,"button",7),w.Wb("click",function(){return e.onClickCancel()}),w.rc(15,"Cancel"),w.Ob(),w.Pb(16,"button",8),w.rc(17,"Add"),w.Ob(),w.Ob(),w.Ob()),2&t&&(w.dc("formGroup",e.form),w.Ab(8),w.dc("ngIf",e.form.get("title").invalid))},directives:[H.n,H.j,H.e,U.f,U.c,X.c,X.f,Q.a,H.b,H.i,H.d,o.j,U.b,V.a,X.b],styles:[".actions[_ngcontent-%COMP%]{justify-content:flex-end}.form-fields[_ngcontent-%COMP%]{display:flex;flex-direction:column}"]}),t})();var tt=n("NFeN"),et=n("MutI"),nt=n("bSwM");const ot=function(t){return[t]},it=function(t){return{"crossed-out":t}};function st(t,e){if(1&t){const t=w.Qb();w.Nb(0),w.Pb(1,"mat-checkbox",1),w.Wb("change",function(e){return w.ic(t),w.ac().onChangeState(e.checked)}),w.Ob(),w.Pb(2,"a",2),w.rc(3),w.Ob(),w.Mb()}if(2&t){const t=w.ac();w.Ab(1),w.dc("checked",t.isDone),w.Ab(1),w.dc("routerLink",w.fc(4,ot,t.todo.id))("ngClass",w.fc(6,it,t.isDone)),w.Ab(1),w.sc(t.todo.title)}}let ct=(()=>{class t{constructor(t){this.store=t}get isDone(){return E.isDone(this.todo)}onChangeState(t){this.store.dispatch(h({todoToUpdate:this.todo,isDone:t}))}}return t.\u0275fac=function(e){return new(e||t)(w.Kb(i.h))},t.\u0275cmp=w.Eb({type:t,selectors:[["app-todo-item"]],inputs:{todo:"todo"},decls:1,vars:1,consts:[[4,"ngIf"],[3,"checked","change"],[1,"todo-title",3,"routerLink","ngClass"]],template:function(t,e){1&t&&w.qc(0,st,4,8,"ng-container",0),2&t&&w.dc("ngIf",e.todo)},directives:[o.j,nt.a,r.f,o.h],styles:["[_nghost-%COMP%]{display:flex;width:100%}.todo-title[_ngcontent-%COMP%]{display:inline-block;padding:0 .5em;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;vertical-align:middle}.todo-title.crossed-out[_ngcontent-%COMP%]{text-decoration:line-through}a[_ngcontent-%COMP%]{color:inherit;text-decoration:none}"]}),t})();function rt(t,e){if(1&t&&(w.Pb(0,"mat-list-item"),w.Lb(1,"app-todo-item",3),w.Ob()),2&t){const t=e.$implicit;w.Ab(1),w.dc("todo",t),w.Bb("id","todo_"+t.id)}}function at(t,e){if(1&t&&(w.Pb(0,"mat-card-content"),w.Pb(1,"mat-list"),w.qc(2,rt,2,2,"mat-list-item",2),w.Ob(),w.Ob()),2&t){const t=w.ac();w.Ab(2),w.dc("ngForOf",t.todos)}}let dt=(()=>{class t{constructor(t,e){this.store=t,this.dialog=e}ngOnInit(){this.store.select(G).subscribe(t=>this.todos=t)}onClickAdd(){this.dialog.open(Z)}}return t.\u0275fac=function(e){return new(e||t)(w.Kb(i.h),w.Kb(U.a))},t.\u0275cmp=w.Eb({type:t,selectors:[["app-todo-list"]],decls:7,vars:1,consts:[["mat-mini-fab","","color","primary",1,"add-todo-button",3,"click"],[4,"ngIf"],[4,"ngFor","ngForOf"],[3,"todo"]],template:function(t,e){1&t&&(w.Pb(0,"mat-card"),w.Pb(1,"mat-card-title"),w.rc(2,"Todo list "),w.Pb(3,"button",0),w.Wb("click",function(){return e.onClickAdd()}),w.Pb(4,"mat-icon"),w.rc(5,"add"),w.Ob(),w.Ob(),w.Ob(),w.qc(6,at,3,1,"mat-card-content",1),w.Ob()),2&t&&(w.Ab(6),w.dc("ngIf",null==e.todos?null:e.todos.length))},directives:[W.a,W.d,V.a,tt.a,o.j,W.b,et.a,o.i,et.b,ct],styles:[".add-todo-button[_ngcontent-%COMP%]{float:right}"]}),t})(),lt=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=w.Eb({type:t,selectors:[["app-todo-page"]],decls:4,vars:0,consts:[[1,"left"],[1,"right"]],template:function(t,e){1&t&&(w.Pb(0,"div",0),w.Lb(1,"app-todo-list"),w.Ob(),w.Pb(2,"div",1),w.Lb(3,"router-outlet"),w.Ob())},directives:[dt,r.h],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column-reverse}.left[_ngcontent-%COMP%], .right[_ngcontent-%COMP%]{flex:1 1 0}.left[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}app-todo-list[_ngcontent-%COMP%]{width:100%}@media (min-width:501px){[_nghost-%COMP%]{flex-direction:row}app-todo-list[_ngcontent-%COMP%]{margin:1em 0;width:500px}}"]}),t})(),bt=(()=>{class t{constructor(t){this.store=t}resolve(t){return this.store.dispatch(O({todoId:+t.params.todoId})),this.store.select($).pipe(Object(a.a)(1),Object(d.a)(()=>!0))}}return t.\u0275fac=function(e){return new(e||t)(w.Tb(i.h))},t.\u0275prov=w.Gb({token:t,factory:t.\u0275fac}),t})();const ut=[{path:"",component:lt,resolve:{todos:K},children:[{path:":todoId",component:z,resolve:{todo:bt}}]}];let Ot=(()=>{class t{}return t.\u0275mod=w.Ib({type:t}),t.\u0275inj=w.Hb({factory:function(e){return new(e||t)},imports:[[r.g.forChild(ut)],r.g]}),t})();const ft=t=>Object.assign(Object.assign({},t),{isLoading:!0}),pt=(t,{error:e})=>Object.assign(Object.assign({},t),{error:e,isLoading:!1}),ht=t=>Object.assign(Object.assign({},t),{isLoading:!1,error:null}),gt={todoList:Object(i.p)(S,Object(i.r)(l,ft),Object(i.r)(b,(t,{todos:e})=>A.addMany(e,ht(t))),Object(i.r)(u,pt),Object(i.r)(h,ft),Object(i.r)(g,(t,{updatedTodo:e})=>(t=ht(t),E.isDone(e)?Object.assign(Object.assign({},t),{ids:[...t.ids.filter(t=>t!==e.id),e.id],entities:Object.assign(Object.assign({},t.entities),{[e.id]:e})}):Object.assign(Object.assign({},t),{entities:Object.assign(Object.assign({},t.entities),{[e.id]:e})}))),Object(i.r)(j,pt),Object(i.r)(m,ft),Object(i.r)(y,(t,{createdTodo:e})=>A.addOne(e,ht(t))),Object(i.r)(v,pt))};var jt=n("LRne"),mt=n("5+tZ"),yt=n("JIr8"),vt=n("vkgz"),Tt=n("XDbj"),Pt=n("tk/3");const Ct=new Map;let wt=(()=>{class t{constructor(t){this.http=t}getTodos(){return this.http.get("assets/mocks/todos.json").pipe(Object(vt.a)(t=>{t.forEach(t=>Ct.set(t.id,Object.assign({},t)))}))}getTodo(t){return Object(jt.a)(Ct.get(t)).pipe(Object(Tt.a)())}updateTodo(t){return Object(jt.a)(Ct.set(t.id,Object.assign({},t)).get(t.id))}createTodo(t){const e=Math.max(0,...Ct.keys())+1;return Object(jt.a)(Ct.set(e,Object.assign(Object.assign({},t),{id:e})).get(e))}}return t.\u0275fac=function(e){return new(e||t)(w.Tb(Pt.a))},t.\u0275prov=w.Gb({token:t,factory:t.\u0275fac}),t})(),It=(()=>{class t{constructor(t,e){this.action$=t,this.todoService=e,this.setTodoList$=Object(s.c)(()=>this.action$.pipe(Object(s.d)(l),Object(mt.a)(()=>this.todoService.getTodos().pipe(Object(d.a)(t=>b({todos:t})),Object(yt.a)(()=>Object(jt.a)(u({error:"Failed to load todos"}))))))),this.updateTodo$=Object(s.c)(()=>this.action$.pipe(Object(s.d)(h),Object(mt.a)(({todoToUpdate:t,isDone:e})=>{const n=Object.assign(Object.assign({},t),{state:e?k.DONE:k.TODO});return this.todoService.updateTodo(n).pipe(Object(d.a)(t=>g({updatedTodo:t})),Object(yt.a)(()=>Object(jt.a)(j({error:"Failed to update todo"}))))}))),this.loadTodo$=Object(s.c)(()=>this.action$.pipe(Object(s.d)(O),Object(mt.a)(({todoId:t})=>this.todoService.getTodo(t).pipe(Object(d.a)(t=>f({todo:t})),Object(yt.a)(()=>Object(jt.a)(p({error:"Failed to retrieve todo"}))))))),this.createTodo$=Object(s.c)(()=>this.action$.pipe(Object(s.d)(m),Object(mt.a)(({todoToCreate:t})=>this.todoService.createTodo(t).pipe(Object(d.a)(t=>y({createdTodo:t})),Object(yt.a)(()=>Object(jt.a)(v({error:"Failed to create todo"})))))))}}return t.\u0275fac=function(e){return new(e||t)(w.Tb(s.a),w.Tb(wt))},t.\u0275prov=w.Gb({token:t,factory:t.\u0275fac}),t})(),Lt=(()=>{class t{}return t.\u0275mod=w.Ib({type:t}),t.\u0275inj=w.Hb({factory:function(e){return new(e||t)},providers:[wt,K,bt],imports:[[o.b,Ot,c.a,i.j.forFeature(D,gt),s.b.forFeature([It])]]}),t})()}}]);